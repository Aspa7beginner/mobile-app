<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-16">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1">
    <title>Sensors</title>
    <link href="sensor.css" rel="stylesheet">
    <script type="text/javascript">
        sensors = ['AbsoluteOrientationSensor', 
                    'Accelerometer',
                    'AmbientLightSensor',
                    'GravitySensor',
                    'Gyroscope',
                    'LinearAccelerationSensor',
                    'Magnetometer',
                    'OrientationSensor',
                    'RelativeOrientationSensor'
        ];
        function display(){
            var results = new Array;
            sensors.forEach(function(element) {
            var de = document.createElement('div');
            if (element in window){
                de.textContent = element + ":true";
                results.push(element+":true")
            }
            else {
                de.textContent = element + ":false";
                results.push(element+":");
            }
            de.innerHtml = "something went wrong";
            document.getElementById('test').appendChild(de);
        });
        return results;
    }


        try {
            accelerometer = new Accelerometer({ frequency: 10 });
            accelerometer.onerror = function(event) {
                // Handle runtime errors.
                if (event.error.name === 'NotAllowedError') {
                    console.log('Permission to access sensor was denied.');
                    document.getElementById('deviceComp').innerHTML = "<p>'Permission to access sensor was denied.</p>";

                } else if (event.error.name === 'NotReadableError') {
                    console.log('Cannot connect to the sensor.');
                    document.getElementById('deviceComp').innerHTML = "<p>Cannot connect to the sensor.</p>";
                }
            };                    
            accelerometer.onreading = function(e) {
                console.log(e);
                document.getElementById('deviceComp').innerHTML = "<p>All OK" + e + "</p>";

            };
            accelerometer.start();
        } catch (error) {
            // Handle construction errors.
            if (error.name === 'SecurityError') {
                console.log('Sensor construction was blocked by the Permissions Policy.');
                document.getElementById('deviceComp').innerHTML = "<p>Sensor construction was blocked by the Permissions Policy.</p>";

            } else if (error.name === 'ReferenceError') {
                console.log('Sensor is not supported by the User Agent.');
                document.getElementById('deviceComp').innerHTML = "<p>Sensor is not supported by the User Agent.</p>";

            } else {
                throw error;
                document.getElementById('deviceComp').innerHTML = "<p>other error.</p>";

            }
        }

    /*for (var element in window.sensors){
        console.log(typeof element);
        console.log(window.sensors[element]);
        
    }*/
    </script>
</head>
<body>
    <h3>Sense Awareness</h3>
    <table>
        <tr><th>Sensors</th><th>Value</th><th>Period</th></tr>
        <tr><td>ExSensor</td><td><span>Val1</span><span>Val2</span></td><td>int1</td></tr>
    </table>
<button> Send </button>
<button onclick="display()"> show </button>
<button onclick="active()"> errors </button>
<div id="test"></div>
<div id="active"></div>
<div id="deviceComp">
</div>
</body>
</html>